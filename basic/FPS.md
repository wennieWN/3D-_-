# Farthest Point Sampling (FPS)

> 点云采样算法
>
> [参考博客](https://zhuanlan.zhihu.com/p/114522377)

### FPS算法的逻辑描述

- 目标：假设有$n$个点，采样出$k$个点（$k<n$）

- 原理概述：所有点归类到两个集合$A,B$。$A$表示选中的点形成的集合，$B$表示未选中的点构成的集合。FPS做的事情是：每次从集合$B$里面选一个到集合$A$里面的点距离最大的点。

- 原理详述：

  - **初始情况**

    集合$A$为空，集合$B$包括所有点。

  - **选第一个点**

    进行Shuffle操作，选第一个点即可。第一个点选完之后，将其移动到集合$A​$中。此时，集合$A​$包含$1​$个点，集合$B​$包含$n-1​$个点。

  - **选第二个点**

    分别计算集合$B$中每个点到集合$A$中的一个点的距离，选距离最大的点，将其移动至集合$A$。此时，集合$A$包含$2$个点，集合$B$包含$n-2$个点。

  - **选第三个点**

    **关键：**如何定义集合$B$里面的点，到集合$A$里面的点的距离？

    假设点$p_B$是集合$B$里面的一个点，计算距离的方式：

    - 分别计算出$p_B$到集合$A$中每个点的距离。
    - 从计算出来的距离值里面，取最小的距离值，作为$p_B$到集合$A$的距离值。

    选出集合$B$中具有最大距离值的点，作为第$3$个点，移动至集合$A$中。此时，集合$A$包含$3$个点，集合$B$包含$n-3$个点。

  - 直到选出$k$个点为止。

### 算法优化

假设此时集合$A$中包含$m$个点，集合$B$中包含$n-m$个点。

选择下一个点时，时间复杂度为$(n-m)*m$。

#### 1. 发现：重复计算的过程

- 选取第$m+1$个点时，集合$A$中包含$m$个点，假设集合$B$中有一个点$p_B$。

  $p_B$至集合$A$的距离：$min({d_B^1, d_B^2,…,d_B^{m-1},d_B^{m}})$

- 退一步来看。选取第$m$个点时，集合$A$中包含$m-1$个点，集合$B$中有一个点$p_B$。

  $p_B$至集合$A$的距离：$min({d_B^1, d_B^2,…,d_B^{m-1}})$

对比发现，重复计算${d_B^1, d_B^2,…,d_B^{m-1}}$。

#### 2. 优化

选取第$m$个点时，保存$t_B^{m-1}=min({d_B^1, d_B^2,…,d_B^{m-1}})$

> $t_B^{m-1}$表示点$p_B$到集合$A$的距离，此时集合$A$有$m-1$个点。

选取第$m+1$个点时，计算$t_B^m=min(t_B^{m-1},d_B^{m})$，保存$t_B^m$

> $t_B^{m}$表示点$p_B$到集合$A$的距离，此时集合$A$有$m$个点。
>
> $d_B^{m}$表示点$p_B$到第$m$个点的距离。

在实现过程中，只需要一个长度为$n$的数组，分别保存每个点到集合$A$的距离。每次选出新的一个点后，更新数组即可。